Title: Service Account Compromise Detection and Response
Severity: High
MITRE ATT&CK: T1078.003
Version: 1.0
Last Updated: 15-Nov-2025
Author: Security Operations Team
Environment: Active Directory, Cloud Services, Applications
Tools: SIEM, Active Directory Auditing, Cloud Logs, EDR
DETECTION:

Service account interactive logon (should only be service logon)
Service account accessed from unusual locations/systems
API calls from service account outside normal patterns
Service account privilege escalation
Service account password spray or brute force attempts
Unusual resource access by service account
Service account used for lateral movement

INVESTIGATION:

Check authentication logs:

Where did service account authenticate? (should only be specific servers)
Logon type (interactive vs service - Type 2 vs Type 5)
Source IP addresses and systems
Timestamp and frequency of access


Review service account activity:

What actions were performed?
Normal vs abnormal behavior patterns
Resource access outside normal scope
API calls or database queries unusual for this account


Identify compromise method:

Credentials stored insecurely? (cleartext in scripts, config files)
Credential dumping from system where service runs?
Kerberoasting attack?
Weak password on service account?


Check systems where service account is used:

Are those systems compromised?
Credential theft from memory or disk?
Review Credential Dumping Runbook



IMMEDIATE ACTIONS:

Disable compromised service account temporarily
Block suspicious source IPs accessing service account
Monitor systems where service account has permissions
Review recent activity for malicious actions

CONTAINMENT:

Rotate service account password immediately
Update service account credentials on all systems using it
Implement Group Managed Service Accounts (gMSA) if possible
Remove unnecessary privileges from service account
Check for persistence mechanisms using service account
Review all systems accessed by compromised service account
Verify no backdoor accounts or scheduled tasks created

POST-INCIDENT:

Document all actions taken by compromised service account
Implement secure credential storage (Azure Key Vault, AWS Secrets Manager)
Review all service accounts for security issues
Monitor service account for 30 days for abuse
Implement service account usage baselines

LESSONS LEARNED:

Use Group Managed Service Accounts (gMSA) in Active Directory
Store service account credentials securely (vaults, not plaintext)
Implement least privilege for all service accounts
Monitor service account for interactive logons (should be rare/never)
Regular service account password rotation
Disable interactive logon for service accounts
Service Principal Names (SPN) security for Kerberoasting prevention
Audit service account permissions quarterly

METADATA:
json{
  "related_runbooks": "Credential Dumping Runbook, Unusual Host Access Runbook, Kerberos Attacks Runbook",
  "ioc": [
    {
      "Type": "account",
      "Value": "svc_compromised",
      "Action": "password_reset",
      "duration_in_days": 0,
      "ckc_stage": "persistence"
    },
    {
      "Type": "IP",
      "Value": "unauthorized_service_access",
      "Action": "blocked",
      "duration_in_days": 90,
      "ckc_stage": "lateral_movement"
    }
  ]
}
