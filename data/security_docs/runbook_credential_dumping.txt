Title: Credential Dumping Detection and Response
Severity: Critical
MITRE ATT&CK: T1003
Version: 1.0
Last Updated: 15-Nov-2025
Author: Security Operations Team
Environment: Endpoints, Domain Controllers, Active Directory
Tools: EDR, SIEM, Windows Event Logs, Memory Forensics
DETECTION:

LSASS.exe memory access by unusual processes
Mimikatz signatures or similar credential dumping tools
Windows Event ID 4656 (handle to LSASS)
SAM registry hive access
DCSync attack indicators (Event ID 4662)
NTDS.dit file access on Domain Controllers
ProcDump or similar tools dumping LSASS

INVESTIGATION:

Check EDR logs for:

Process accessing LSASS memory
Command-line arguments (look for mimikatz, procdump)
User account performing credential dump
Timestamp of credential access


Review Windows Event Logs:

Event ID 4656 (handle to object - LSASS)
Event ID 4663 (object access - SAM registry)
Event ID 4662 (DCSync - DS Replication)


Identify credential dumping technique:

LSASS memory dump (Mimikatz, ProcDump)
SAM registry extraction
DCSync (replicating password hashes from DC)
NTDS.dit file theft


Determine scope:

What accounts' credentials were dumped?
Domain admin credentials compromised?
How many systems affected?



IMMEDIATE ACTIONS:

Isolate affected system immediately
Force password reset for all potentially compromised accounts
Disable compromised accounts until investigation complete
Block lateral movement attempts from affected system
Enable enhanced monitoring on Domain Controllers

CONTAINMENT:

Kill credential dumping processes
Check for tools like Mimikatz, ProcDump on system
Review all systems accessed by compromised accounts
Force organization-wide password reset if domain admin compromised
Enable Credential Guard on all endpoints
Check for Golden Ticket or Silver Ticket attacks
Review Kerberos ticket anomalies

POST-INCIDENT:

Rebuild compromised Domain Controllers if NTDS.dit stolen
Implement LSASS protection (Protected Process Light)
Enable Windows Defender Credential Guard
Monitor for 30 days for credential abuse
Document all compromised accounts and reset timeline

LESSONS LEARNED:

Implement Credential Guard on all endpoints
Protected Process Light (PPL) for LSASS
Privileged Access Workstations (PAW) for admin accounts
Monitor LSASS access continuously
Disable weak authentication protocols (NTLMv1, LM)
Regular credential rotation for privileged accounts
Multi-factor authentication enforcement

METADATA:
json{
  "related_runbooks": "Unusual Host Access Runbook, Privilege Escalation Runbook, Malware Infection Runbook",
  "ioc": [
    {
      "Type": "process",
      "Value": "mimikatz.exe",
      "Action": "deleted",
      "duration_in_days": 0,
      "ckc_stage": "credential_access"
    },
    {
      "Type": "file",
      "Value": "lsass.dmp",
      "Action": "deleted",
      "duration_in_days": 0,
      "ckc_stage": "credential_access"
    }
  ]
}
