import requests
import os
import sys
sys.path.append(os.getcwd())
from src.logger_config import get_logger

logger=get_logger(__name__)

def fetch_cisa_kev():
    logger.debug("Fetching CISA kev")
    kev_url="https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"
    response= requests.get(kev_url)
    response.raise_for_status()
    print(response)

def fetch_epss_score(cve_ids:list):
    logger.debug("Fetching EPSS score")
    epss_url=f"https://api.first.org/data/v1/epss?cve={cve_ids}"
    response=requests.get(epss_url)
    response.raise_for_status()
    print(response.json())



if __name__=="__main__":
    #fetch_cisa_kev()
    fetch_epss_score("CVE-2025-24893")
